# 需要geneset1，geneset2，geneset3
# BiocManager::install('ggvenn')
library(patchwork)
library(ggsci)
library(ggvenn)
library(ggplot2)

# List of items
vennpic1 <- do.call(cbind,lapply(geneset1, function(f){
  lapply(f,function(n){
    n$genenames
  })
}))
vennpic2 <- do.call(cbind,lapply(geneset2, function(f){
  lapply(f,function(n){
    n$genenames
  })
}))
vennpic3 <- do.call(cbind,lapply(geneset3, function(f){
  lapply(f,function(n){
    n$genenames
  })
}))
vennpic <- rbind(vennpic1,rbind(vennpic2,vennpic3))
colnames(vennpic) <- c('M','S')

vennpicname<- c("LYM","OLG","MG","NPC","Mo/Ma","AS","GRA","EpC","NC","EC","PC")
rownames(vennpic) <- vennpicname
names(vennpicname) <- vennpicname
# vennpic <- lapply(vennpicname, function(x){
#   ggvenn(vennpic[x,]) +
#     labs(title=x)+
#     theme_void()+
#     theme(plot.title=element_text( hjust=0.5, vjust=-15))+scale_fill_nejm()
# 
# })

vennpic <- lapply(vennpicname, function(x){
  ggvenn(vennpic[x,],set_name_size = 3,text_size = 4 ,show_percentage = F) +
    labs(title=x)+
    theme_void()+
    theme(plot.title=element_text( hjust=0.5))+scale_fill_nejm()
  
})








vennpic[["MG"]] <- vennpic[["MG"]]+theme(plot.title=element_text( hjust=0.5, vjust=-7))

saveRDS(vennpic,file = 'downstream analysis/vennpic.rds')

vennpic <- readRDS('downstream analysis/vennpic.rds')





layout <- "
#BC#
AKKD
EKKF
GHIJ
"


figs3 <- vennpic$LYM +vennpic$OLG +vennpic$NPC + 
  vennpic$`Mo/Ma`+vennpic$AS+vennpic$GRA+
  vennpic$EpC+vennpic$NC+vennpic$EC+
  vennpic$PC+vennpic$MG+
  plot_layout(design = layout)
