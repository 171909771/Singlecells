### 载入包及相关基因集P2 genesets
```r
library(AUCell)
library(clusterProfiler)
library(ggplot2)
library(Seurat)
library(SeuratData)

geneSets <- readRDS('meta_cor_mcao24h.rds')
geneSets <- subset(geneSets,V2>0.8)
geneSets <- geneSets$names
```

### 方法一：AUCell函数,只需要输入 seurat data（dataset）和基因集（geneset）
```r
### 载入函数
AUCmethod <- function(dataset,geneset){
  ### 排序
  cells_rankings <- AUCell_buildRankings(dataset@assays[["alra"]]@data)  # 关键一步
  cells_AUC <- AUCell_calcAUC(geneset, cells_rankings, aucMaxRank=nrow(cells_rankings)*0.1)
  dataset$AUC <- as.numeric(cells_AUC@assays@data@listData[["AUC"]])
  return(dataset)
}
### 获取AUC值
dat1 <- AUCmethod(dat1,geneSets)
```

### 方法二：AddModuleScore函数获取
```r
## seurat 自身聚类AddModuleScore
dat1 <-  AddModuleScore(object = dat1,list(geneSets))
## 只看比其他基因更高的表达值
dat1@meta.data[["Cluster1"]][dat1@meta.data[["Cluster1"]]<0]=0
## seurat可视化
FeaturePlot(dat1, 'AUC')
```

### monocle可视化
```r
library("ggsci")
cds@phenoData@data[["AUC"]] <- as.numeric(dat1@meta.data[["AUC"]])
plot_cell_trajectory(cds, color_by = "AUC") + scale_color_gsea()
```



