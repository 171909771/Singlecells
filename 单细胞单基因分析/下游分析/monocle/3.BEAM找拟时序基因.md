### find gene based on the pseudotime
```r
BEAM_res <- BEAM(cds, branch_point = 5, cores = 4)
BEAM_res <- BEAM_res[order(BEAM_res$qval),]
BEAM_res <- BEAM_res[,c("gene_short_name", "pval", "qval")]
```

### 载入P2基因列表
```r
geneSets <- readRDS('meta_cor_mcao24h.rds')
geneSets <- subset(geneSets,V2>0.8)
geneSets <- geneSets$names
```

### 载入修改的函数后作图
```r
library(pheatmap)
p <- tmpheatmap(cds[row.names(subset(BEAM_res,
                                     qval < 1e-4 | gene_short_name == 'P2ry6')),],
                branch_point = 1,
                num_clusters = 6,
                cores = 1,
                use_gene_short_name = T,
                show_rownames = T,
                return_heatmap = TRUE,
                geneSets=c(geneSets,"P2ry6"))
```
![image](https://user-images.githubusercontent.com/41554601/202494956-bc3aa45a-5bff-4eb5-b041-c89f1778ce47.png)

### 单个基因画图
```r
plot_genes_branched_pseudotime(cds[head(rownames(p$annotation_row)[p$annotation_row==2]),],
                               branch_point = 1,
                               ncol = 1)
```
![image](https://user-images.githubusercontent.com/41554601/202495235-7d59edce-0cf1-40f9-b612-b672e8fa0ce7.png)

